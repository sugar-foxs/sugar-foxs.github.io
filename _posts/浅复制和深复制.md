---
layout:     post
title:      浅复制和深复制
subtitle:   
date:       2017-08-27
author:     sugar-foxs
catalog: 	true
tags:
    - java
    - spring
---

本文主要介绍浅复制和深复制的区别。

<!-- more -->

# 浅复制和深复制

- 浅复制：被复制对象的所有变量都含有与原来的对象相同的值，而所有的对其他对象的引用仍然指向原来的对象。换言之，浅复制仅仅复制所考虑的对象，而不复制它所引用的对象。 

- 深复制：被复制对象的所有变量都含有与原来的对象相同的值，除去那些引用其他对象的变量。那些引用其他对象的变量将指向被复制过的新对象，而不再是原有的那些被引用的对象。换言之，深复制把要复制的对象所引用的对象都复制一遍。

## 浅复制
```java
class Professor implements Cloneable {
    String name;
    int age;
    Professor(String name,int age) {
        this.name=name;
        this.age=age;
    }
}

public class Student implements Cloneable {
    String name;
    int age;
    Professor p;
    Student(String name,int age,Professor p) {
        this.name=name;
        this.age=age;
        this.p=p;
    }
    public Object clone() {
        Student o=null;
        try {
            o=(Student)super.clone();
        } catch(CloneNotSupportedException e) {
            System.out.println(e.toString());
        }
        return o;
    }
    public static void main(String[] args) {
        Professor p=new Professor("wangwu",50);
        Student s1=new Student("zhangsan",18,p);
        Student s2=(Student)s1.clone();
        s2.p.name="lisi";
        s2.p.age=30;
        
        System.out.println("name="+s1.p.name+","+"age="+s1.p.age);
        System.out.println("name="+s2.p.name+","+"age="+s2.p.age);
    }
}
```
> 输出结果是：
name=lisi,age=30
name=lisi,age=30

- 所以浅复制的话，同一个引用指向是同一个对象，互相影响。

## 深复制
```java
class Professor implements Cloneable {
    String name;
    int age;
    Professor(String name,int age) {
        this.name=name;
        this.age=age;
    }
    //不一样的地方
    public Object clone() {
        Object o=null;
        try {
            o=super.clone();
        } catch(CloneNotSupportedException e) {
            System.out.println(e.toString());
        }
        return o;
    }
}

public class Student implements Cloneable {
    String name;
    int age;
    Professor p;
    Student(String name,int age,Professor p) {
        this.name=name;
        this.age=age;
        this.p=p;
    }
    public Object clone() {
        Student o=null;
        try {
            o=(Student)super.clone();
        } catch(CloneNotSupportedException e) {
            System.out.println(e.toString());
        }
        //对引用的对象也进行复制,深复制
        o.p=(Professor)p.clone();
        return o;
    }
    public static void main(String[] args) {
        Professor p=new Professor("wangwu",50);
        Student s1=new Student("zhangsan",18,p);
        Student s2=(Student)s1.clone();
        s2.p.name="lisi";
        s2.p.age=30;
        //学生1的教授不改变。
        System.out.println("name="+s1.p.name+","+"age="+s1.p.age);
        System.out.println("name="+s2.p.name+","+"age="+s2.p.age);
    }
}
```
> 输出结果：
name=wangwu,age=50
name=lisi,age=30

- 所以深复制的话，改变其中一个对象，另一个对象不受影响。

